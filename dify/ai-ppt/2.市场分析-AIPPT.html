<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Rspress v1.43.9">
    <title data-rh="true">市场分析-AIPPT - akira-blog</title>
  <script>{;const saved = localStorage.getItem('rspress-theme-appearance');const preferDark = window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = !saved || saved === 'auto' ? preferDark : saved === 'dark';document.documentElement.classList.toggle('dark', isDark);document.documentElement.style.colorScheme = isDark ? 'dark' : 'light';}</script><link rel="icon" href="/blog/rspress-icon.png"><script defer src="/blog/static/js/styles.cb278b64.js"></script><script defer src="/blog/static/js/lib-react.509de283.js"></script><script defer src="/blog/static/js/lib-router.9c922211.js"></script><script defer src="/blog/static/js/121.af252e41.js"></script><script defer src="/blog/static/js/index.106e0a4c.js"></script><link href="/blog/static/css/styles.f50526a2.css" rel="stylesheet"></head>

  <body >
    <div id="root"><div class="navContainer_d18b1 rspress-nav px-6  sticky_ddfa7"><div class="container_e4235 flex justify-between items-center h-full"><div class="navBarTitle_c5f07"><a class="link_a7cea flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60 cursor-pointer" target="" href="/blog/index.html"><div class="mr-1 min-w-8"><img src="/blog/rspress-light-logo.png" alt="logo" id="logo" class="rspress-logo dark:hidden"/><img src="/blog/rspress-dark-logo.png" alt="logo" id="logo" class="rspress-logo hidden dark:block"/></div></a></div><div class="flex flex-1 justify-end items-center"><div class="rightNav_a2fea"><div class="flex sm:flex-1 items-center sm:pl-4 sm:pr-2"><div class="rspress-nav-search-button navSearchButton_df1fb"><button><svg width="18" height="18" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9"></path></svg><p class="searchWord_af2c1">Search Docs</p><div style="opacity:0"><span></span><span>K</span></div></button></div><div class="mobileNavSearchButton_d85a9"><svg width="24" height="24" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9"></path></svg></div></div><div class="rspress-nav-menu menu h-14"><a class="link_a7cea  cursor-pointer" target="" href="/blog/dify/index.html"><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-1.5 px-3 py-2 flex items-center">dify</div></a><a class="link_a7cea  cursor-pointer" target="" href="/blog/antd-design/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">antd-design</div></a><a class="link_a7cea  cursor-pointer" target="" href="/blog/large-screen/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">数字大屏</div></a><a class="link_a7cea  cursor-pointer" target="" href="/blog/project-plan/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">解决方案</div></a><a class="link_a7cea  cursor-pointer" target="" href="/blog/about/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">关于作者</div></a></div><div class="flex-center flex-row"><div class="mx-2"><div class="md:mr-2 rspress-nav-appearance"><div class="p-1 border border-solid border-gray-300 text-gray-400  cursor-pointer rounded-md hover:border-gray-600 hover:text-gray-600 dark:hover:border-gray-200 dark:hover:text-gray-200 transition-all duration-300 w-7 h-7"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="dark:hidden" width="18" height="18" fill="currentColor"><path d="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6m0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4M12 4c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1M12 24c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1M5.6 6.6c-.3 0-.5-.1-.7-.3L3.5 4.9c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.1.2-.4.3-.7.3M19.8 20.8c-.3 0-.5-.1-.7-.3l-1.4-1.4c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.2.2-.5.3-.7.3M3 13H1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1M23 13h-2c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1M4.2 20.8c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.4.3-.7.3M18.4 6.6c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.5.3-.7.3"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="hidden dark:block" width="18" height="18" fill="currentColor"><path d="M12.1 22h-.9c-5.5-.5-9.5-5.4-9-10.9.4-4.8 4.2-8.6 9-9 .4 0 .8.2 1 .5s.2.8-.1 1.1c-2 2.7-1.4 6.4 1.3 8.4 2.1 1.6 5 1.6 7.1 0 .3-.2.7-.3 1.1-.1.3.2.5.6.5 1-.2 2.7-1.5 5.1-3.6 6.8-1.9 1.4-4.1 2.2-6.4 2.2M9.3 4.4c-2.9 1-5 3.6-5.2 6.8-.4 4.4 2.8 8.3 7.2 8.7 2.1.2 4.2-.4 5.8-1.8 1.1-.9 1.9-2.1 2.4-3.4-2.5.9-5.3.5-7.5-1.1-2.8-2.2-3.9-5.9-2.7-9.2"></path></svg></div></div></div><div class="social-links menu-item_e90a6 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/akira0912" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_a4ad0"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></div></a></div></div></div></div><div class="mobileNavMenu_e7045"><div class="navScreen_ec30c  rspress-nav-screen" id="navScreen"><div class="container_c935d"><div class="navMenu_b887b"><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/blog/dify/index.html"><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-1.5 px-3 py-2 flex items-center">dify</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/blog/antd-design/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">antd-design</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/blog/large-screen/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">数字大屏</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/blog/project-plan/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">解决方案</div></a></div><div class="navMenuItem_e7978 w-full"><a class="link_a7cea  cursor-pointer" target="" href="/blog/about/index.html"><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">关于作者</div></a></div></div><div class="flex-center flex-col gap-2"><div class="mt-2 navAppearance_bf893 flex justify-center"></div><div class="social-links menu-item_e90a6 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/akira0912" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_a4ad0"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></div></a></div></div></div></div></div><button aria-label="mobile hamburger" class=" rspress-mobile-hamburger navHamburger_ac64c text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="currentColor"><circle cx="8" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="24" cy="16" r="2" fill="currentColor"></circle></svg></button></div></div></div></div><section><div class="docLayout_af141 pt-0"><aside class="sidebar_dd719 rspress-sidebar "><div class="navTitleMask_fb17c"><div class="navBarTitle_c5f07"><a class="link_a7cea flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60 cursor-pointer" target="" href="/blog/index.html"><div class="mr-1 min-w-8"><img src="/blog/rspress-light-logo.png" alt="logo" id="logo" class="rspress-logo dark:hidden"/><img src="/blog/rspress-dark-logo.png" alt="logo" id="logo" class="rspress-logo hidden dark:block"/></div></a></div></div><div class="rspress-scrollbar sidebarContent_da296"><nav class="pb-2"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/blog/dify/index.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:14px;margin-left:0;border-radius:0 var(--rp-radius) var(--rp-radius) 0;padding-left:24px;font-weight:bold"><span>Dify 文档中心</span></div></a><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/blog/dify/AI大模型应用调研-Dify部署.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:14px;margin-left:0;border-radius:0 var(--rp-radius) var(--rp-radius) 0;padding-left:24px;font-weight:bold"><span>AI大模型应用调研-Dify部署</span></div></a><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">ai-ppt</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/blog/dify/ai-ppt/1.生成PPT并导出.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>生成PPT并导出</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/blog/dify/ai-ppt/2.市场分析-AIPPT.html"><div class="menuItemActive_de63c mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>市场分析-AIPPT</span></div></a></div><div class="rspress-sidebar-item"><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/blog/dify/ai-ppt/3.AIPPT的架构设计说明.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>AIPPT的架构设计说明</span></div></a></div></div></div></section><a class="link_a7cea menuLink_bb039 cursor-pointer" target="" href="/blog/dify/生成多种类型的分析报告（类似秘塔）.html"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:14px;margin-left:0;border-radius:0 var(--rp-radius) var(--rp-radius) 0;padding-left:24px;font-weight:bold"><span>生成多种类型的分析报告（类似秘塔）</span></div></a></nav></div></aside><div class="flex-1 relative min-w-0"><div class="rspress-sidebar-menu-container "><div class="rspress-sidebar-menu"><button type="button" class="flex-center mr-auto"><div class="text-md mr-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M4 6h24v2H4zm0 18h24v2H4zm0-12h24v2H4zm0 6h24v2H4z"></path></svg></div><span class="text-sm">Menu</span></button><button type="button" class="flex-center ml-auto"><span class="text-sm">ON THIS PAGE</span><div class="text-md mr-2" style="transform:rotate(0deg);transition:transform 0.2s ease-out;margin-top:2px"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></button><div class="rspress-local-toc-container "><ul><li><a href="#pptist" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">PPTist</span></a></li><li><a href="#dify工作流" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">DIFY工作流</span></a></li><li><a href="#会话变量" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">会话变量</span></a></li><li><a href="#问题分类器" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">问题分类器</span></a></li><li><a href="#联网搜索" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">联网搜索</span></a></li><li><a href="#生成json格式的ppt元素" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">生成JSON格式的PPT元素</span></a></li><li><a href="#ppt内容生成" class="rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">PPT内容生成</span></a></li></ul></div></div></div><div class="content_ff766 rspress-doc-container flex"><div class="flex-1 overflow-x-auto"><div class="rspress-doc"><!--$--><h1 id="市场分析-aippt" class="rspress-doc-title text-3xl mb-10 leading-10 tracking-tight title_fb7eb">市场分析-AIPPT<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#市场分析-aippt">#</a></h1>
<p class="my-4 leading-7">接着上篇的AIPPT继续，我们换的第二种方案是<strong class="font-semibold">PPT低代码设计器+DIFY</strong>工作流的形式，用到的技术栈：Vue3、Typescript、Express。流程是：运用DIFY工作流的多轮对话和用户交流-》市场分析-》生成PPT大纲市和具体内容-》生成json-》在线编辑PPT-》导出PPT文件。</p>
<p class="my-4 leading-7">项目基于PPTist写了后端服务（因为PPTist是纯前端的，需要加上后端支持），前端加了路由和接口请求，套了一层对话框，目前可以实现AI搜索网络内容后，自动生成PPT，且可在线编辑PPT文档，可在固定位置生成图表，可直接导出发送到邮箱。</p>
<p class="my-4 leading-7">效果如下： <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c46aad5b1848462a85b6dce26803badb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=Ii7p0%2Fp1dLg%2F0VDaSXPAoyBNZ6I%3D" alt="image.png"/></p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a5b24c8ca9b415fb1e548c591ecf1ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=Ln6i0uYLxlZBaXE4PaQNVmXuhlk%3D" alt="1bd8b4d83c8a04e197ef22154ba9125.png"/></p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae2b9d1e791f4daa96a1d627888f62af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=a%2B6vcnb1xITIuma7S2qd2No2uN4%3D" alt="c94c090ff011ec9254a5414030ecfc3.png"/></p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c3c218d1c1145339e397dcfe9a6c34f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=7WNoQrv%2FkUvdV5sFL2rAqcGRqa4%3D" alt="05e7a236d13ba5bcee1375713baeefb.png"/></p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7c3dc64595e46a9b474c957ebd7b181~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=JparQkdgq%2BQpCJz045dCkITKDPE%3D" alt="185c9cfcad4f8e2ae94addde28ff641.png"/></p>
<p class="my-4 leading-7">这种DIFY与前后端结合，把AI灵活嵌入到我们的前后端项目中的方式，也是我觉得现在的AI项目最好的应用。因为DIFY能够简化数据管理和处理，集成了多种AI工具，前端可以通过API直接调用工作流，和DIFY进行交互，后端可以专注于业务逻辑处理，也可以写接口让dify调用。虽然，现在的agent平台大多数都提供iframe嵌入网页的功能，但这样并不灵活，有很多限制，所以最好还是自己去写聊天框接入。</p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/958e05f35f954d4c922b37187de6e3ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=qNYaM97Zez9DXOyclyI9%2FtEZhu8%3D" alt="image.png"/></p>
<h2 id="pptist" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">PPTist<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#pptist">#</a></h2>
<p class="my-4 leading-7">PPTist是Github上一个6.3k star的开源前端项目<a title="https://github.com/pipipi-pikachu/PPTist" target="_blank" rel="noopener noreferrer" href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpipipi-pikachu%2FPPTist" class="link_a7cea  link_a9ef4 inline-link_f855c">github.com/pipipi-pika…</a></p>
<p class="my-4 leading-7">每一页PPT，其实都是一个json格式的Slide数组。每一个PPT元素，都通过JSON进行精确控制和定制。这样结构化的方式，可以很方便地生成、修改和保存PPT文件。每一个Slide对象都可能包括：幻灯片的标题、内容、样式、布局、动画，图片、视频、图表等元素都可以通过定制json对象来完成，项目中TS文件也很明确地规定了类型，可以仔细看一下。</p>
<p class="my-4 leading-7">示例：官方默认PPT页面，这个页面通过@/src/mocks/slides.ts文件里的slides对象数组控制。</p>
<p class="my-4 leading-7">所以我们的AIPPT的思路，就是让ai去生成这个json对象，我们拿到json之后就可以直接渲染出PPT进行在线编辑。</p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b2a3d42ee304548929bf305ca96edc5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=cQxLPB80VqHkLy324Pp6UfEIy0U%3D" alt="image.png"/></p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d88a8bf3d50f4b22bef8b1c2ec5bd9a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=xWwog5l%2F4Kct6QLqF0Ah%2FS0H280%3D" alt="image.png"/></p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5bf6f8683e974329a7996911f87f53c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=RcVTrwgDpEN5lZ82HYXiE%2BJ%2Bwew%3D" alt="image.png"/></p>
<h2 id="dify工作流" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">DIFY工作流<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#dify工作流">#</a></h2>
<p class="my-4 leading-7">我们在项目的前端调用DIFY工作流的API，工作流大致如下图所示，本来还希望加上知识库联合搜索，因为dify自带的知识库不太好用，所以知识库的技术方案还在考虑中。 <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/226ee126fb59480b9e300a9bd0e2e10a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=9KLaN9Maj2wkWfM1a6fW4TLJXiw%3D" alt="image.png"/></p>
<h3 id="会话变量" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">会话变量<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#会话变量">#</a></h3>
<p class="my-4 leading-7">DIFY里面有一个会话变量，可以存储读写一些上下文数据，借助这个，我们和用户进行对轮对话。本文中的应用就是记录大纲内容，通过会话的方式可以对大纲进行反复的修改。 <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6379a23d595e4f56b39de8cb6b77be13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=WQaPxAPXTa5UEW99SLsIB0YBYPM%3D" alt="image.png"/></p>
<h3 id="问题分类器" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">问题分类器<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#问题分类器">#</a></h3>
<p class="my-4 leading-7">DIFY中的问题分类器可以帮助我们做意图识别，在对话中判断用户的意图，然后走对应的流程，本工作流会判断用户是从零开始生成大纲，还是要修改PPT大纲，还是需要直接生成PPT文件。</p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6884b56ecba474b8a584e1637fc93cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=hlALBAQgBenn%2BlF4kW5YlsiwYdg%3D" alt="image.png"/></p>
<h3 id="联网搜索" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">联网搜索<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#联网搜索">#</a></h3>
<p class="my-4 leading-7">在撰写大纲内容的时候，我们需要从网络获取数据，用到了Moonshot联网搜索的API，这个功能DIFY的LLM结点并不支持，所以需要我们自己添加HTTP结点，调用后端写好的联网搜索接口。</p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4411d82bcb324742ac455fb19a9ca686~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=3HSKEZl9qZFw8pUzYRLak%2BuR3ak%3D" alt="image.png"/></p>
<p class="my-4 leading-7"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94a792fa07344aa0aad8996ef4913088~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWtpcmEwOTEy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1743674347&amp;x-signature=3zEITki56HyXAQsIemwtmoDWGPs%3D" alt="image.png"/></p>
<h3 id="生成json格式的ppt元素" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">生成JSON格式的PPT元素<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#生成json格式的ppt元素">#</a></h3>
<p class="my-4 leading-7">大模型在输出JSON格式的回复的时候，经常会报错，要注意max-token的设置，json过长时会被截断，这样获取的json在转换时会报错。很多大模型都有指定输出格式的功能，比如moonshot可以指定输出json_object，但是在实际使用的时候，发现moonshot在输出json的时候还是有很多问题，最后决定用glm-4-plus，通过细化提示词的方式，尽量让大模型输出一个PPT的json格式。</p>
<div class="language-markdown"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-markdown" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-punctuation);font-weight:bold">#</span><span class="token" style="color:#EBCB8B;font-weight:bold"> Role: PPT 优化专家</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">你是一个专业的 PPT 优化专家，能够充分利用用户提供的内容，自动优化并生成精美的 ppTist 的 json 结构，可以渲染出 ppt。
</span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation);font-weight:bold">##</span><span class="token" style="color:#EBCB8B;font-weight:bold"> Goals</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">-</span><span> 根据用户提供的内容，进行正确的PPT分页，自动优化并生成精美的 ppTist 的 json 结构，可以渲染出 ppt。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">-</span><span> 所输出的内容必须是有效的 json 格式，不能偏离格式要求。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">-</span><span> 请确保 PPT 的内容准确、客观，不包含虚假信息。
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation);font-weight:bold">##</span><span class="token" style="color:#EBCB8B;font-weight:bold"> Output Format</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem">````json
</span><span style="display:block;padding:0 1.25rem">{
</span><span style="display:block;padding:0 1.25rem">  &quot;type&quot;: &quot;ppt&quot;,
</span><span style="display:block;padding:0 1.25rem">  &quot;content&quot;: {
</span><span style="display:block;padding:0 1.25rem">    &quot;title&quot;: &quot;主标题&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;subtitle&quot;: &quot;副标题&quot;,
</span><span style="display:block;padding:0 1.25rem">    &quot;content&quot;: [
</span><span style="display:block;padding:0 1.25rem">      {
</span><span style="display:block;padding:0 1.25rem">        &quot;sectionTitle&quot;: &quot;章节标题&quot;,
</span><span style="display:block;padding:0 1.25rem">        &quot;subsections&quot;: [
</span><span style="display:block;padding:0 1.25rem">          {
</span><span style="display:block;padding:0 1.25rem">            &quot;title&quot;: &quot;子章节标题&quot;,
</span><span style="display:block;padding:0 1.25rem">            &quot;points&quot;: [&quot;子章节内容点1&quot;, &quot;子章节内容点2&quot;, &quot;子章节内容点3&quot;]
</span><span style="display:block;padding:0 1.25rem">          },
</span><span style="display:block;padding:0 1.25rem">          {
</span><span style="display:block;padding:0 1.25rem">            &quot;title&quot;: &quot;另一个子章节标题&quot;,
</span><span style="display:block;padding:0 1.25rem">            &quot;points&quot;: [&quot;另一个子章节内容点1&quot;, &quot;另一个子章节内容点2&quot;]
</span><span style="display:block;padding:0 1.25rem">          }
</span><span style="display:block;padding:0 1.25rem">        ]
</span><span style="display:block;padding:0 1.25rem">      },
</span><span style="display:block;padding:0 1.25rem">      {
</span><span style="display:block;padding:0 1.25rem">        &quot;sectionTitle&quot;: &quot;另一个章节标题&quot;,
</span><span style="display:block;padding:0 1.25rem">        &quot;subsections&quot;: [
</span><span style="display:block;padding:0 1.25rem">          {
</span><span style="display:block;padding:0 1.25rem">            &quot;title&quot;: &quot;子章节标题&quot;,
</span><span style="display:block;padding:0 1.25rem">            &quot;points&quot;: [&quot;子章节内容点1&quot;, &quot;子章节内容点2&quot;]
</span><span style="display:block;padding:0 1.25rem">          }
</span><span style="display:block;padding:0 1.25rem">        ]
</span><span style="display:block;padding:0 1.25rem">      }
</span><span style="display:block;padding:0 1.25rem">    ]
</span><span style="display:block;padding:0 1.25rem">  }
</span><span style="display:block;padding:0 1.25rem">}
</span><span style="display:block;padding:0 1.25rem">``` //
</span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation);font-weight:bold">##</span><span class="token" style="color:#EBCB8B;font-weight:bold"> Constrains</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">1.</span><span> 检查 PPT 中的文本内容，确保每一页的内容充实，不能文字过少，正确进行分页，相关内容放在一页。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">2.</span><span> 优化语言表达，使其更加简洁、清晰、有逻辑性，提高可读性。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">3.</span><span> 对标题进行润色，使其更具吸引力。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation);font-weight:bold">##</span><span class="token" style="color:#EBCB8B;font-weight:bold"> Skills</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">-</span><span> 只处理与 PPT 制作相关的内容，拒绝回答与 PPT 无关的话题。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">-</span><span> 所输出的内容必须是有效的 json 格式，不能偏离格式要求。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">-</span><span> 请确保 PPT 的内容准确、客观，不包含虚假信息。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation);font-weight:bold">##</span><span class="token" style="color:#EBCB8B;font-weight:bold"> Workflow</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">1.</span><span> 学习 Outputformat，保证输出根据模板来。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">2.</span><span> 根据输入的信息，分析出主题信息。
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token list" style="color:var(--code-token-punctuation)">3.</span><span> 结合模板，输入的信息，输出 json 数据。</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<div class="language-bash"><div class="rspress-code-content rspress-scrollbar"><code>
前端的聊天框组件，在读取到\`\`\`json开头 并且是json格式的内容的时候，确认需要生成PPT文件，这时候会调用PPT生成接口。

````js
  // 文字解析
  async textFormat(chatContent: IMessage, message: Partial&lt;IBotMsg&gt;) {
    chatContent.msg = message.content || &#x27;&#x27;
    chatContent.msgType = &#x27;text&#x27;
    if (chatContent.msg.includes(&#x27;```json&#x27;) &amp;&amp; chatContent.msg.includes(&#x27;ppt&#x27;)) {
      const link = await generatePPt(chatContent.msg)
      chatContent.msg = `PPT已生成，请点击查看 ${link}`
    }
    return chatContent
  }
</code></div></div>
<p class="my-4 leading-7">由此可以看出来，聊天框我们可以设计为为多种类型的，img、text、json、loading等。</p>
<h3 id="ppt内容生成" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">PPT内容生成<a class="link_a9ef4 header-anchor" aria-hidden="true" href="#ppt内容生成">#</a></h3>
<p class="my-4 leading-7">后端在收到json格式的内容之后，经过格式转换和解析，一页页生成PPT元素，</p>
<div class="language-js"><div class="rspress-code-content rspress-scrollbar"><div><pre class="code" style="background-color:inherit"><code class="language-js" style="white-space:pre"><span style="display:block;padding:0 1.25rem"><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> homePage </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">require</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;./page/home&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> endPage </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">require</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;./page/end&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> headlinePage </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">require</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;./page/headline&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> listPage </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">require</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;./page/list&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">const</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span> </span><span class="token literal-property" style="color:var(--code-token-parameter)">v4</span><span class="token operator">:</span><span> uuidv4 </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span> </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">require</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-string)">&#x27;uuid&#x27;</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-keyword)">class</span><span> </span><span class="token class-name">AstPpt</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  ppt</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-function)">constructor</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">ppt</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>ppt </span><span class="token operator">=</span><span> ppt</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-function)">setPpt</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">ppt</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>ppt </span><span class="token operator">=</span><span> ppt</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem">
</span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-comment)">// 首页</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-function)">homePage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> </span><span class="token" style="color:var(--code-token-function)">homePage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>ppt</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-function)">content</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> contentList </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>ppt</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>content</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">forEach</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">item</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> index</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token operator">=&gt;</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> headline </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">headlinePage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>item</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>sectionTitle</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      contentList</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">push</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>headline</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>Array</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">isArray</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>item</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>subsections</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> list </span><span class="token operator">=</span><span> item</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>subsections</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">map</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">subsection</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> subsectionIndex</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token operator">=&gt;</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>          </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> </span><span class="token" style="color:var(--code-token-function)">listPage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-function)">uuidv4</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> subsection</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>title</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> subsection</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>points</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>        contentList</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">push</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token operator">...</span><span>list</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> contentList</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-comment)">// 结束页</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-function)">endPage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> </span><span class="token" style="color:var(--code-token-function)">endPage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>ppt</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-comment)">// 生成图表</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-function)">generateChart</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">echartData</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token operator">!</span><span>echartData</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">if</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>Object</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">keys</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>echartData</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>length </span><span class="token operator">===</span><span> </span><span class="token number">0</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> chartData </span><span class="token operator">=</span><span> echartData</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    chartData</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>id </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">uuidv4</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    chartData</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>elements </span><span class="token operator">=</span><span> chartData</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>elements</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">map</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">item</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token operator">=&gt;</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      item</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>id </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-function)">uuidv4</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> item</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> chartData</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-function)">generatePpt</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token parameter">ppt</span><span class="token parameter" style="color:var(--code-token-punctuation)">,</span><span class="token parameter"> echartData</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">{</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">setPpt</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>ppt</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">const</span><span> slides </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-punctuation)">[</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">homePage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token" style="color:var(--code-token-comment)">// 首页</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">generateChart</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span>echartData</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token" style="color:var(--code-token-comment)">// 图表</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token operator">...</span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">content</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token" style="color:var(--code-token-comment)">// 内容</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>      </span><span class="token" style="color:var(--code-token-keyword)">this</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span class="token" style="color:var(--code-token-function)">endPage</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">,</span><span> </span><span class="token" style="color:var(--code-token-comment)">// 结束页</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-punctuation)">]</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>    </span><span class="token" style="color:var(--code-token-keyword)">return</span><span> slides</span><span class="token" style="color:var(--code-token-punctuation)">;</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>  </span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span></span><span class="token" style="color:var(--code-token-punctuation)">}</span><span>
</span></span><span style="display:block;padding:0 1.25rem"><span>module</span><span class="token" style="color:var(--code-token-punctuation)">.</span><span>exports </span><span class="token operator">=</span><span> </span><span class="token" style="color:var(--code-token-keyword)">new</span><span> </span><span class="token class-name">AstPpt</span><span class="token" style="color:var(--code-token-punctuation)">(</span><span class="token" style="color:var(--code-token-punctuation)">)</span><span class="token" style="color:var(--code-token-punctuation)">;</span></span></code></pre></div><div class="code-button-group_fb445"><button title="Toggle code wrap"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrapped_fb89b"><path fill="#22a041" d="M21 5H3v2h18zM3 19h7v-2H3zm0-6h15c1 0 2 .43 2 2s-1 2-2 2h-2v-2l-4 3 4 3v-2h2c2.95 0 4-1.27 4-4 0-2.72-1-4-4-4H3z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="icon-wrap_ccd3d"><path fill="currentColor" d="M16 7H3V5h13zM3 19h13v-2H3zm19-7-4-3v2H3v2h15v2z"></path></svg></button><button class="code-copy-button_c5089" title="Copy code"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 30 30" class="icon-copy_ef942"><path fill="currentColor" d="M28 10v18H10V10zm0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"></path><path fill="currentColor" d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z"></path></svg><svg width="32" height="32" viewBox="0 0 30 30" class="icon-success_d5ec0"><path fill="#49cd37" d="m13 24-9-9 1.414-1.414L13 21.171 26.586 7.586 28 9z"></path></svg></button></div></div></div>
<p class="my-4 leading-7">其中一步是生成图表，我的做法是图表独立于大纲，单独生成，之后再嵌入到PPT的固定位置。比如在PPT的结尾，加上对市场的预测数据。如果有固定的工作流的话，可以在每个位置都判断一下是否有足够的数据，支持图表生成。</p>
<p class="my-4 leading-7">其实图表的生成有很多的方式：</p>
<ol class="list-decimal pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">DIFY支持直接输出echarts图表；</li>
<li class="[&amp;:not(:first-child)]:mt-2">让大模型直接给svg代码；</li>
<li class="[&amp;:not(:first-child)]:mt-2">本文给出的，生成一个PPT图表元素。等等。</li>
</ol>
<p class="my-4 leading-7">主要的问题是缺数据支撑，而且不能保证大模型给的数据的准确性，这才是最头疼的地方。所以我们才会考虑做知识库，数据从网络和知识库两个地方抓取。</p>
<p class="my-4 leading-7">最后，项目还有很多需要优化的地方，连接本地知识库、图表的优化、PPT内容的优化、token消耗量等等，很多地方都有坑，感兴趣的朋友可以一起聊聊，后面准备做多工作流的集成，求大佬指导。感谢。</p><!--/$--></div><div class="rspress-doc-footer"><footer class="mt-8"><div class="xs:flex pb-5 px-2 justify-end items-center"></div><div class="flex flex-col"></div><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_c92d1 flex flex-col"><a class="link_a7cea pager-link_e0d2d cursor-pointer" target="" href="/blog/dify/ai-ppt/1.生成PPT并导出.html"><span class="desc_dcc01">Previous Page</span><span class="title_a3acb">生成PPT并导出</span></a></div><div class="next_c11be flex flex-col"><a class="link_a7cea pager-link_e0d2d next_ad355 cursor-pointer" target="" href="/blog/dify/ai-ppt/3.AIPPT的架构设计说明.html"><span class="desc_dcc01">Next Page</span><span class="title_a3acb">AIPPT的架构设计说明</span></a></div></div></footer></div></div><div class="aside-container_bc5fa"><div class="flex flex-col"><div id="aside-container" class="relative text-sm font-medium"><div class="leading-7 block text-sm font-semibold pl-3">ON THIS PAGE</div><nav class="mt-1"><ul class="relative"><li><a href="#pptist" title="PPTist" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">PPTist</span></a></li><li><a href="#dify工作流" title="DIFY工作流" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">DIFY工作流</span></a></li><li><a href="#会话变量" title="会话变量" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">会话变量</span></a></li><li><a href="#问题分类器" title="问题分类器" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">问题分类器</span></a></li><li><a href="#联网搜索" title="联网搜索" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">联网搜索</span></a></li><li><a href="#生成json格式的ppt元素" title="生成JSON格式的PPT元素" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">生成JSON格式的PPT元素</span></a></li><li><a href="#ppt内容生成" title="PPT内容生成" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">PPT内容生成</span></a></li></ul></nav></div></div></div></div></div></div></section></div>
    <div id="search-container"></div>
  </body>
</html>
