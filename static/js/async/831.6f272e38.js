"use strict";(self.webpackChunkakira_blog=self.webpackChunkakira_blog||[]).push([["831"],{2917:function(n,e,i){i.r(e),i.d(e,{default:()=>c});var a=i(2676),r=i(453);function t(n){let e=Object.assign({h1:"h1",a:"a",p:"p",code:"code",pre:"pre",img:"img"},(0,r.ah)(),n.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.h1,{id:"iframe的加载时展示loading动画动态加载路由伪",children:["iframe的加载时展示loading动画&动态加载路由（伪）",(0,a.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#iframe的加载时展示loading动画动态加载路由伪",children:"#"})]}),"\n",(0,a.jsx)(e.p,{children:"最近有一个需求需要在页面内嵌一个iframe，用来加载其他网站，第一次使用iframe，研究了一下。 在网上看到了形形色色的判断iframe是否加载的方式，用了最简单的一种，直接加一个onload函数判断，onload 事件在frame或者iframe载入完成后被触发。"}),"\n",(0,a.jsxs)(e.p,{children:["ps：感觉iframe的坑好多，有很多的网站是不支持被iframe内嵌的，比如百度、知乎等…1. 添加一个",(0,a.jsx)(e.code,{children:"X-Frame-Options"}),"响应头就行了"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-ini",children:" const [loading, setLoading] = useState<boolean>(true);\n const [url, setUrl] = useState<string>('');\n \n //useEffect加载数据……\n \n return (\n    <ProCard style={{ width: '100%', height: '100%' }} ghost>\n      {loading && (\n        <div className={styles.spin}>\n          <Spin spinning={loading} tip={'加载中…'} delay={100} />\n        </div>\n      )}\n      {url && (\n        <iframe\n          src={url}\n          width={'100%'}\n          height={'100%'}\n          frameBorder={'false'}\n          onLoad={() => {\n            setLoading(false);\n          }}\n        />\n      )}\n      {/* </Spin> */}\n    </ProCard>\n  );\n \n \n //index.less spin加个遮罩层 直接问chatGPT\n .spin {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 208px;\n  z-index: 9999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(0, 0, 0, 0.1);\n}\n\n"})}),"\n",(0,a.jsxs)(e.p,{children:["效果 ",(0,a.jsx)(e.img,{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f18d8431e02a4c0394e31d3873a4326c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})]}),"\n",(0,a.jsxs)(e.p,{children:["如图 需求还有一点是外链的地址需要动态加载出来的，但是我们路由是静态的配置路由（umi）。看了文档之后发现可以在layout那边用 ",(0,a.jsx)(e.code,{children:"menuDataRender"}),"来动态修改路由，但是如果要异步加载的话需要用到",(0,a.jsx)(e.code,{children:"menu.request"})]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abdd1dae2cb74cccb02649106aaa16b1~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})}),"\n",(0,a.jsx)(e.p,{children:"最后发现components是动态挂载不上去的，所以只能增加了path之后，把所有的path都映射到已有的页面组件。"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/efe1f22c300f410f95451d3716eff7cf~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/31132d593c33491881ddc68ea858ed7b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})}),"\n",(0,a.jsx)(e.p,{children:"还在研究若依的动态路由、约定式路由，有些地方实在看不懂orz。。。"})]})}function s(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,r.ah)(),n.components);return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(t,{...n})}):t(n)}let c=s;s.__RSPRESS_PAGE_META={},s.__RSPRESS_PAGE_META["project-plan%2Fiframe%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%97%B6%E5%B1%95%E7%A4%BAloading%E5%8A%A8%E7%94%BB%26%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E8%B7%AF%E7%94%B1%EF%BC%88%E4%BC%AA%EF%BC%89.md"]={toc:[],title:"iframe的加载时展示loading动画&动态加载路由（伪）",headingTitle:"iframe的加载时展示loading动画&动态加载路由（伪）",frontmatter:{}}}}]);