"use strict";(self.webpackChunkakira_blog=self.webpackChunkakira_blog||[]).push([["620"],{8836:function(e,n,c){c.r(n),c.d(n,{default:()=>p});var s=c(2676),i=c(453);function r(e){let n=Object.assign({p:"p",ul:"ul",li:"li",blockquote:"blockquote",strong:"strong",img:"img",h3:"h3",a:"a",code:"code",pre:"pre",ol:"ol"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"之前说的做做公司组织架构树的时候用到了tree组件，现在有两个改动："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"tree节点可选择，但是antd提供的是多选，没有单选的，所以要把原组件改成单选。"}),"\n",(0,s.jsx)(n.li,{children:"树展开的时候太长了，需要对树的展示高度进行限制。"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["tree组件有一个很好用的东西是onCheck、onExpend函数传入值里面有节点信息，这个信息很重要。 function(checkedKeys, ",(0,s.jsx)(n.strong,{children:"e:{checked: bool, checkedNodes, node, event, halfCheckedKeys}"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/36962c3333614939997da6bb213b4ad5~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})}),"\n",(0,s.jsxs)(n.h3,{id:"一tree组件改成单选",children:["一、tree组件改成单选",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#一tree组件改成单选",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"这个其实并不难，虽然antd没有提供，但是可以自己进行改造。改造起来也很容易："}),"\n",(0,s.jsxs)(n.p,{children:["1、是把样式改了，因为传统的checkbox，方框都是表示多选，圆框是单选，其实就是加个",(0,s.jsx)(n.code,{children:"border-radius"}),"样式"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c717b707c7424412aba3aaf1d89fc0c8~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"改造成↓"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68b8b1038c2043119b7662ad090c5528~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})}),"\n",(0,s.jsx)(n.p,{children:"代码："}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:".checkbox {\n  margin-left: 20px;\n  :global {\n    .ant-tree-checkbox-inner {\n      border-radius: 50% !important;\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"二是通过逻辑实现单选，一行代码搞定，用点击的节点的key直接替代掉原来的checkedkey数组。"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"onCheck={(_, e) => {\n     setCheckedKeys([e.node.key]);\n}}\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"二限制树高",children:["二、限制树高",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#二限制树高",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"有两种办法："}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["tree的层级是",(0,s.jsx)(n.strong,{children:"公司-事业处-部门-子部门"}),"。同一个部门只能展开一个，也就是有一个展开的时候，点另外一个节点时，原结点收起，现点击的结点展开。"]}),"\n",(0,s.jsx)(n.li,{children:"对容纳tree的容器进行高度限制，tree高度超过容器时，展示滚动条。"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"第一种"})," ",(0,s.jsx)(n.img,{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9139355f9ca437b8a98687022e950f1~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"第二种"}),(0,s.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/574706ff9505454188209e8c6c772e78~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})]}),"\n",(0,s.jsxs)(n.p,{children:["第二种办法很简单 加个样式即可",(0,s.jsx)(n.code,{children:"style={{ height: 200, overflow: 'auto ' }}"})]}),"\n",(0,s.jsxs)(n.p,{children:["第一种代码如下，有",(0,s.jsx)(n.code,{children:"e.node.pos、e.expanded"}),"的信息就非常好写："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"       const keyLevelMap = useRef(new Map()); //记录每一个展开节点的level\n       \n     //同时只展开一个部门/事业处/公司\n            onExpand={(key, e) => {\n              console.log(e);\n              //e.node.pos第一层0-0，第二层0-0-0，第三层0-0-0-0……\n              //e.expanded展开/收起 我记录旧值的样子好像小丑……\n              if (e.expanded) {\n                const level: number = e.node.pos.split('-').length - 1;\n                keyLevelMap.current.set(e.node.key, level); //位置\n                const filterKey: Key[] = [];\n                key.map((item) => {\n                  if (keyLevelMap.current.get(item) != level) {\n                    filterKey.push(item);\n                  }\n                });\n                filterKey.push(e.node.key); //加上自身\n                setExpandKeys(filterKey);\n              } else {\n                setExpandKeys(key);\n              }\n            }}\n"})}),"\n",(0,s.jsx)(n.p,{children:"最开始我不知道有传入的e记录了节点的展开、层级等，然后我就在死做，记录展开的旧值，和新值做对比，得出展开还是收起，以及展开的节点，然后再写些逻辑。"}),"\n",(0,s.jsx)(n.p,{children:"我们第一层的key是c0、c1，第二层的key是c0-m0,c0-m1，第三层部门的key是number类型的id（类似23、29这样的）…我就按照这个规律死做，最后意识到部门底下还有层级 还有子部门，这样写完全不行emmm…没有规律，因为部门和子部门都是number类型id毫无规律，不好控制，其实有上述那么简单的做法，我自己瞎搞这么复杂。"}),"\n",(0,s.jsx)(n.p,{children:"我一开始还觉得treeNode给的api太少了，给我一个字段加层级多好，想不到官方已经做好了层级的记录- -"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/26c77ed6d75c4932af9d410c4ed7af6f~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})}),"\n",(0,s.jsxs)(n.p,{children:["（在犯蠢= =ifelse工程师） ",(0,s.jsx)(n.img,{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ab5526ea2f424089956b4a7ef1728cce~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?",alt:"image.png"})]}),"\n",(0,s.jsx)(n.p,{children:"总结下来还是要仔细的看文档，灵活应用，害= =白白浪费时间写错误的做法，记录下来，以后不走弯路。"})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(r,{...e})}):r(e)}let p=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["antd-design%2Ftree%2F2.%E6%94%B9%E6%88%90%E5%8D%95%E9%80%89%26%E5%90%8C%E4%B8%80%E5%B1%82%E7%BA%A7%E5%8F%AA%E8%83%BD%E5%B1%95%E5%BC%80%E4%B8%80%E4%B8%AA%EF%BC%88%E7%82%B9%E5%87%BB%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9%E6%97%B6%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%B1%95%E5%BC%80%E8%8A%82%E7%82%B9%E6%94%B6%E8%B5%B7%EF%BC%89.md"]={toc:[{text:"一、tree组件改成单选",id:"一tree组件改成单选",depth:3},{text:"二、限制树高",id:"二限制树高",depth:3}],title:"",headingTitle:"",frontmatter:{}}}}]);